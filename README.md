# 🚀 AI 기반 슬랙-구글 시트 주문 관리 자동화 시스템

> **실무에서의 비정형 메시지 분석부터 데이터 동기화까지, 하나로 해결하는 업무 자동화 솔루션**

이 프로젝트는 친구 회사의 수동 주문 관리 프로세스를 자동화하기 위해 개발된 **개인 맞춤형 업무 자동화 봇**입니다. 슬랙 메시지를 Gemini AI로 분석하여 구글 스프레드시트에 구조화된 데이터로 기록하며, 실시간 수정 및 삭제 동기화를 지원합니다.

---

## 🌟 핵심 가치 (Value Proposition)

- **생산성 향상**: 수동 타이핑 및 복사-붙여넣기 업무를 100% 자동화하여 데이터 입력 오류 방지 및 시간 절약.
- **AI 하이브리드 분석**: 단순 정규식과 LLM(Gemini)을 결합하여 운영 비용을 최소화하면서도 높은 문장 해석력 유지.
- **데이터 무결성**: 슬랙 메시지의 편집/삭제가 시트에 실시간 반영되어 데이터의 일관성 보장.
- **사용자 친화적 설계**: 비전공자도 관리할 수 있는 웹 기반 설정 UI 및 원클릭 실행 스크립트(`start.bat`) 제공.

---

## 🛠 기술 스택 (Tech Stack)

| 구분 | 기술 | 비고 |
| :--- | :--- | :--- |
| **Language** | Node.js | 서버 로직 및 API 연동 |
| **AI** | Gemini 1.5 Flash | 비정형 주문 메시지 파싱 및 오탈자 교정 |
| **Messaging** | Slack Bolt SDK | 슬랙 이벤트 핸들링 및 대화형 UI(Block Kit) |
| **Storage** | Google Sheets API | 서비스 계정(Service Account) 기반 데이터 기록 |
| **Web UI** | Express, EJS, CSS | 봇 설정 및 API 키 관리 UI |
| **DevOps** | ngrok | 로컬 서버 외부 노출 및 슬랙 웹훅 수신 |

---

## 🚀 주요 기능 (Key Features)

### 1. 지능형 메시지 분석 (Hybrid Parsing)
- **Fast Path**: "업체명 제품 수량" 형태의 정형 데이터는 로컬 정규식으로 즉시 처리 (비용 0원).
- **AI Path**: 복잡한 문장이나 심한 오탈자가 포함된 경우 Gemini AI가 문맥을 파악해 데이터 추출.
- **Normalization**: '녹섹 -> 녹색', '퍼렁 -> 파랑' 등 회사별 특화 어휘 자동 교정.

### 2. 실시간 CRUD 동기화
- **승인 시스템**: 봇이 분석한 결과를 사용자에게 먼저 보여주고 [승인/취소] 버튼을 통해 최종 기록 결정.
- **Update/Delete**: 슬랙 메시지를 수정하면 시트 내용이 즉시 바뀌고, 메시지를 지우면 시트의 행도 자동 삭제.

### 3. 통합 및 업체별 시트 분리
- **Master Sheet**: 모든 주문 내역을 첫 번째 탭에 날짜순으로 자동 누적.
- **Company Tabs**: 업체별로 탭을 자동 생성하여 업체별 데이터 관리 편의성 극대화.

### 4. 시트 데이터 보호 (Row Locking)
- **수동 관리 보호**: 사용자가 시트의 **'비고'**란에 내용을 입력하면, 봇은 해당 행을 "최종 확정 데이터"로 판단합니다.
- **편집 제한**: 비고란이 채워진 행은 이후 슬랙 메시지를 수정하거나 삭제하더라도 시트에서 변경되지 않고 그대로 보존됩니다.

---

## 📸 실행 화면 (Demo)

*(여기에 슬랙 봇이 답변하는 스크린샷이나 시트로 데이터가 들어가는 스크린샷을 첨부하면 좋습니다!)*

---

## 💻 설치 및 실행 (Installation)

1. **Repository 클론**
   ```bash
   git clone https://github.com/your-username/slack-automation.git
   cd slack-automation
   ```

2. **라이브러리 설치**
   ```bash
   npm install  # 또는 install.bat 실행
   ```

3. **서버 실행**
   ```bash
   npm start    # 또는 start.bat 실행
   ```

4. **웹 설정**
   `http://localhost:3000`에 접속하여 Slack API 키와 Google 서비스 계정 정보를 입력하세요.

---

## 📝 프로젝트 후기 및 교훈
- **사용자 중심 개발**: 사용자가 시트를 직접 열지 않고도 슬랙 내에서 모든 편집을 끝낼 수 있도록 설계하여 업무 효율을 높였습니다.
- **비용 최적화**: API 호출 비용을 고려해 AI 호출 전 로컬 필터링 단계를 둔 점이 실무적으로 큰 의미가 있었습니다.
- **코드 유연성**: 서비스 계정 방식을 도입하여 보안성을 높이고 타 기기에서의 초기 설정 난이도를 획기적으로 낮췄습니다.
